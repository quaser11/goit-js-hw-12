{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api-service.js","../src/js/view-more-btn-service.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport {Notify} from 'notiflix/build/notiflix-notify-aio';\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst BASE_KEY = '44168245-b85e0b025332670cfa54a187d';\n\nexport default class PixabayApiService {\n  constructor(query) {\n    this.query = query;\n    this.page = 1\n  }\n\n  async fetchByQuery() {\n    const perPage = 40\n    const params = {\n      'key': BASE_KEY,\n      'q': this.query,\n      'image_type': 'photo',\n      'orientation': 'horizontal',\n      'safesearch': 'true',\n      'page': this.page,\n      'per_page': perPage\n    };\n\n    const response = await axios.get(BASE_URL, {params});\n    return {...response.data, perPage}\n\n  }\n\n  resetPage() {\n    this.page = 1\n  }\n\n  incrementPage() {\n    this.page += 1\n  }\n}","export default class ViewMoreBtnService {\n  constructor(selector, isHiiden = true) {\n    this.selector = selector;\n\n    isHiiden && this.hide()\n  }\n\n  getRef(){\n    const viewMoreBtn = document.querySelector(`${this.selector}`);\n    const spinner = viewMoreBtn.querySelector('.spinner-border');\n    const text = viewMoreBtn.querySelector('.btn-primary__text');\n\n    return {viewMoreBtn, spinner, text}\n  }\n\n  disabled(){\n    const viewMoreBtn = this.getRef().viewMoreBtn;\n    const text = this.getRef().text;\n    const spinner = this.getRef().spinner\n\n    viewMoreBtn.classList.remove('is-hidden');\n    text.innerHTML = 'Loading'\n    viewMoreBtn.disabled = true;\n    spinner.classList.remove('is-hidden');\n  }\n\n  enabled(){\n    const viewMoreBtn = this.getRef().viewMoreBtn;\n    const text = this.getRef().text;\n    const spinner = this.getRef().spinner;\n\n    viewMoreBtn.disabled = false;\n    text.innerHTML = 'View More';\n    spinner.classList.add('is-hidden');\n  }\n\n  hide(){\n    this.getRef().viewMoreBtn.classList.add('is-hidden')\n  }\n}","import {Notify} from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport PixabayApiService from \"./pixabay-api-service\";\nimport ViewMoreBtnService from \"./view-more-btn-service\";\nimport '../css/index.css'\nimport 'modern-normalize'\n\n\nconst searchForm = document.getElementById('search-form');\nconst cardsBlock = document.querySelector('.request-info-section__cards')\n\nconst pixabayApiService = new PixabayApiService();\nconst viewMoreBtnService = new ViewMoreBtnService('.btn-primary');\n\nsearchForm.addEventListener('submit', onSubmit)\nviewMoreBtnService.getRef().viewMoreBtn.addEventListener('click', onViewMoreBtnClick)\n\nfunction onSubmit(e) {\n  e.preventDefault()\n  const query = document.getElementsByName('searchQuery')[0].value;\n\n  if (!query) return;\n  pixabayApiService.query = query\n\n  cardsBlock.innerHTML = '';\n  pixabayApiService.resetPage()\n\n  getInfoAndAppend()\n}\n\n\nfunction makeMarkUp(arr) {\n  const result = arr.map((item) => {\n    return `<div class=\"request-info-section__card\">\n        <div class=\"request-info-section__card__image\">\n                    <a href=\"${item.largeImageURL}\" class=\"original-image\"><img src=\"${item.webformatURL}\" alt=\"\" title=\"${item.tags}\"/></a>\n        </div>\n        <div class=\"request-info-section__card__image__info\">\n          <div class=\"request-info-section__card__user__info\">\n            <div class='request-info-section__card__user__info__image'><img src=\"${item.userImageURL}\" alt=\"\"></div>\n            <span class=\"request-info-section__card__user__info__name\">${item.user}</span>\n          </div>\n          <div class=\"request-info-section__card__user__info__about\">\n            <div class=\"request-info-section__card__user__info__about__first\">\n              <div class=\"request-info-section__card__user__info__about__info\">\n                <div class=\"request-info-section__card__user__info__about__info__first__block\">\n                  <p style=\"margin:0;\">Views: <span>${item.views}</span></p>\n                  <p style=\"margin:0;\">Downloads: <span>${item.downloads}</span></p>\n                </div>\n                <div class=\"request-info-section__card__user__info__about__info__second__block\">\n                  <p style=\"margin:0;\">Likes: <span>${item.likes}</span></p>\n                  <p style=\"margin:0;\">Comments: <span>${item.comments}</span></p>\n                </div>\n              </div>\n            </div>\n            <div>\n              <h6>Image Size</h6>\n              <div class=\"request-info-section__card__user__info__about__image__size\">${item.imageWidth}x${item.imageHeight}</div>\n            </div>\n          </div>\n        </div>\n        <div class=\"url__thumb\">\n          <a href=\"${item.pageURL}\">Pixabay Image URL</a>\n        </div>\n      </div>`\n  }).join('')\n\n  return result\n}\n\nfunction onViewMoreBtnClick() {\n  pixabayApiService.incrementPage()\n  getInfoAndAppendOnViewMoreBtn()\n}\n\nfunction getInfoAndAppend(scroll) {\n  viewMoreBtnService.disabled()\n  pixabayApiService.fetchByQuery().then(response => {\n    checkOn(response)\n    cardsBlock.insertAdjacentHTML('beforeend', makeMarkUp(response.hits))\n    var lightbox = new SimpleLightbox('.request-info-section__cards .original-image', {captionDelay: 250})\n    lightbox.refresh()\n    viewMoreBtnService.enabled()\n  }).catch(error => Notify.failure('failure'))\n}\n\nfunction getInfoAndAppendOnViewMoreBtn() {\n  viewMoreBtnService.disabled()\n  pixabayApiService.fetchByQuery().then(response => {\n    checkOn(response)\n    cardsBlock.insertAdjacentHTML('beforeend', makeMarkUp(response.hits))\n    var lightbox = new SimpleLightbox('.request-info-section__cards .original-image', {captionDelay: 250})\n    lightbox.refresh()\n    viewMoreBtnService.enabled()\n    doSmoothScroll()\n  }).catch(error => Notify.failure('failure'))\n}\nfunction checkOn(response){\n  if (Number(pixabayApiService.page) >= Math.ceil(Number(response.totalHits) / response.perPage)) {\n    Notify.warning('We\\'re sorry, but you\\'ve reached the end of search results.')\n    viewMoreBtnService.hide()\n  }\n  if (response.hits.length === 0) {\n    Notify.failure('Sorry, there are no images matching your search query. Please try again.')\n    viewMoreBtnService.hide()\n    return\n  }\n}\nfunction doSmoothScroll() {\n  const {height: cardHeight} = document\n    .querySelector(\".request-info-section__cards\")\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top:cardHeight / 3,\n    behavior: \"smooth\",\n  });\n}"],"names":["BASE_URL","BASE_KEY","PixabayApiService","query","params","axios","ViewMoreBtnService","selector","isHiiden","viewMoreBtn","spinner","text","searchForm","cardsBlock","pixabayApiService","viewMoreBtnService","onSubmit","onViewMoreBtnClick","e","getInfoAndAppend","makeMarkUp","arr","item","getInfoAndAppendOnViewMoreBtn","scroll","response","checkOn","lightbox","SimpleLightbox","error","Notify","doSmoothScroll","cardHeight"],"mappings":"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"}